<!--pages/store/store.wxml-->

<!-- 导入数据处理函数 -->
<wxs src="../wxs/fStr.wxs" module="fStr"> </wxs>

<!-- 引入自定义的tabbar -->
<custom-tabbar list="{{tabs}}" cst-tabbar="cst-tabbar2" act-img="act-img2" act-text="act-text2" bind:tabbarChange="tabbarChange2">

  <!-- 美食页面 -->
  <block wx:if="{{tabs[0].isActive}}">
    <top-search placehod="搜美食..." topcss="topcss">
      <view slot="the_location" class="self-location">
        <text class="iconfont icon-location"></text>
        <text class="location-name" bindtap="handleLocDetail">东方之珠</text>
        <text class="iconfont {{location_detail? 'icon-right':'icon-down'}}"></text>
      </view>
    </top-search>

    <view class="store-hotword"></view>
    <!-- 美食页面的轮播图 -->
    <view class="store-swipers">
      <swiper class="swipers"
              indicator-dots 
              indicator-color="rgba(230,230,230,0.2)"
              indicator-active-color="rgba(0,0,0,0.6)"
              autoplay
              interval="{{4000}}"
              duration="{{600}}"
              circular
              easing-function="linear">
        <block wx:for="{{img_arr}}" wx:key="index">
          <swiper-item item-id="index">
            <image src="/assets/swipers/{{item}}"></image>
          </swiper-item>
        </block>
      </swiper>
    </view>


    <!-- 美食页面的中部导航 -->
    <view  class="nav-container">
      <view class="store-select">
        <text>综合排序></text>
        <text>距离</text>
        <text>销量</text>
        <text>筛选</text>
      </view>

      <scroll-view class="store-nav" scroll-x enable-flex scroll-with-animation>
        <view wx:for="{{nav_arr}}" id="item.id" wx:key="id" class="nav-item {{item.isActive? 'nav-active':''}}" bindtap="handleNavChange" data-index="{{index}}">
          <image class="nav-item-img" src="{{fStr.formatStr('swipers',item.icon)}}"></image>
          <text class="nav-item-title">{{item.title}}</text>
          <view class="nav-item-underline"></view>
        </view>
        
      </scroll-view>
    </view>
    <!-- 中部导航 固定定位,替换区域 -->
    <view class="nav-container-place" hidden="{{is_hidden}}">
      <view class="store-select">
        <text>综合排序></text>
        <text>距离</text>
        <text>销量</text>
        <text>筛选</text>
      </view>

      <scroll-view class="store-nav" scroll-x enable-flex scroll-with-animation>
        <view wx:for="{{nav_arr}}" id="item.id" wx:key="id" class="nav-item {{item.isActive? 'nav-active':''}}" bindtap="handleNavChange" data-index="{{index}}">
          <image class="nav-item-img" src="{{fStr.formatStr('swipers',item.icon)}}"></image>
          <text class="nav-item-title">{{item.title}}</text>
          <view class="nav-item-underline"></view>
        </view>
        
      </scroll-view>
    </view>
   
   
    <!-- 美食页面的内容部分 -->
    <view class="store-content">
      <view class="store-listbox" wx:for="{{list_arr}}" wx:key="index" bindtap="handleStoreItem">
        <view class="listbox-img">
          <image src="{{fStr.formatStr('swipers',item.ava)}}"></image>
        </view>
        <view class="listbox-content">
          <view class="listbox-name">{{item.name}}</view>
          <view class="listbox-amount">
            <text class="listbox-amount-grade">评{{item.grade}}</text>
            <text class="listbox-amount-text">月售 ¥{{item.amount}}</text>
          </view>
          <view class="listbox-sendmin">起送 ¥{{item.sendmin}}</view>
          <view class="listbox-discounts">
            <c-tag wx:for="{{item.discounts}}" wx:for-item="itemdis" wx:for-index="indexdis" wx:key="indexdis" name="{{itemdis}}" tagcss="tagcss"></c-tag>
          </view>
          <!-- 商品列表 -->
          <scroll-view class="listbox-goods" scroll-x  scroll-with-animation>
            <view class="goods-box"  id="index2" wx:for="{{item.goods}}" wx:for-item="item2" wx:for-index="index2" wx:key="index2">
              <image src="{{fStr.formatStr('swipers',item2.img)}}"></image>
              <view class="dishes">{{item2.name}}</view>
              <view class="price">
                <text class="new_price">¥{{item2.new_price}}</text>
                <text class="old_price">¥{{item2.old_price}}</text>
              </view>
            </view>
          </scroll-view>

        </view>
      </view>
    </view>
  </block>

  <!-- 超市页面 -->
  <block wx:if="{{tabs[1].isActive}}">
    <view>奶茶果汁</view>
  </block>

  <!-- 购物车页面 -->
  <block wx:if="{{tabs[2].isActive}}">
    <view>优惠热卖</view>
  </block>
  
</custom-tabbar>
